services:
    website:
        container_name: website
        #image: realprojectsegfault/website:latest
        restart: unless-stopped
        build:
            context: .
            dockerfile: Dockerfile
        ports:
            - 1339:3000
        environment:
          AUTH_SECRET: ${AUTH_SECRET}
          AUTH_TRUST_HOST: ${AUTH_TRUST_HOST}
          AUTH_URL: ${AUTH_URL}
          DB_HOST: ${DB_HOST}
          DB_PORT: ${DB_PORT}
          DB_USERNAME: ${DB_USERNAME}
          DB_PASSWORD: ${DB_PASSWORD}
          AUTH_CLIENT_ID: ${AUTH_CLIENT_ID}
          AUTH_CLIENT_SECRET: ${AUTH_CLIENT_SECRET}
          AUTH_ISSUER: ${AUTH_ISSUER}
          HCAPTCHA_SECRET: ${HCAPTCHA_SECRET}
          HCAPTCHA_SITEKEY: ${HCAPTCHA_SITEKEY}
          WEBHOOK: ${WEBHOOK}
        #args: [ "ORIGIN=" ]

    website-db:
        image: mongo
        container_name: website-db
        restart: unless-stopped
        volumes:
            - website-db-data:/data/db
        environment:
            MONGO_INITDB_ROOT_USERNAME: $MONGO_USER
            MONGO_INITDB_ROOT_PASSWORD: $MONGO_PASSWORD
            MONGO_INITDB_DATABASE: website
        command: [--auth]

volumes:
    website-db-data: